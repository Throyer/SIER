<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
    <head th:replace="~{fragments/fragments :: head (title='Edificios')}"></head>

    <!-- Estilo Gerenciamento -->
    <link th:replace="~{fragments/css :: gerenciamento-css}"/>

    <!-- Estilo dataTables bootstrap 4 -->
    <link th:replace="~{fragments/css :: dataTables-bootstrap-css}"/>
    <body>
        <!-- Navbar -->
        <nav th:replace="~{fragments/fragments :: navbar (gerenciamento='true')}"></nav>

        <div class="container-fluid">
            <div class="row">
                <!-- Lateral sidebar Edificio -->
                <nav th:replace="~{fragments/fragments :: sidebar-edificio (index='true')}">sidebar Edificio</nav>

                <!-- Container edificios -->
                <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
                    <div class="table-responsive">
                        <h4>Base de dados de Edificios Resisdenciais</h4>

                        <!-- Edição Sucesso -->
                        <div th:if="${atualizado}" class="alert alert-warning alert-dismissible fade show" role="alert">
                            <small>Edificio <strong><span th:text="${atualizado.nome}"></span></strong> atualizado com sucesso!</small>
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">
                                    <i class="fas fa-times"></i>
                                </span>
                            </button>
                        </div>

                        <!-- Tabela de Edificios -->
                        <table id="edificios" class="table table-sm">
                            <thead>
                                <tr>
                                    <th scope="col">Nome</th>
                                    <th scope="col">Nome Conhecido</th>
                                    <th scope="col">Construção</th>
                                    <th scope="col">Andares</th>
                                    <th scope="col"><i class="fas fa-map-marker-alt"></i> Endereço</th>
                                    <th scope="col">Fonte</th>
                                    <th scope="col">Data coleta</th>
                                    <th scope="col"><i class="fas fa-user-graduate"></i> Ultima edição</th>
                                    <th scope="col" class="text-center">Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="edificio : ${edificios}"
                                    th:class="${atualizado} ? (${edificio.id == atualizado.id} ? 'table-warning' : '')">
                                    <td><span th:text="${#strings.isEmpty(edificio.nome)} ? 'Não registrado' : ${edificio.nome}"></span></td>
                                    <td><span th:text="${#strings.isEmpty(edificio.nomeConhecido)} ? 'Não registrado' : ${edificio.nomeConhecido}"></span></td>
                                    <td><span th:text="${edificio.dataConstrucao} ? ( ${#dates.format(edificio.dataConstrucao, 'dd/MM/yyyy')} ) : 'Não registrado'"></span></td>
                                    <td><span th:text="${edificio.numeroAndares}"></span></td>
                                    <td><span th:utext="${edificio.cep.cep + '<strong> n° </strong>' + edificio.numero}"></span></td>
                                    <td><span th:text="${edificio.fonteColeta}"></span></td>
                                    <td><span th:text="${#dates.format(edificio.dataColeta, 'dd/MM/yyyy')}"></span></td>
                                    <td><span th:text="${edificio.usuario.nome + ' ' + edificio.usuario.sobrenome}"></span></td>
                                    <td>
                                        <div th:switch="${usuario.cargo.nome}"
                                             class="btn-group" role="group" aria-label="First group">
                                             <!--<button type="button" class="btn btn-dark"><i class="far fa-eye"></i></button>-->
                                             <a th:href="@{/edificio/visualizar/{id}(id=${edificio.id})}" title='Editar'
                                           class="btn btn-primary" role="button">
                                                <i class="far fa-eye"></i>
                                            </a>
                                            <a th:href="@{/edificio/editar/{id}(id=${edificio.id})}" title='Editar'
                                               class="btn btn-primary" role="button">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table><!-- /Fim da tabela de edificios -->
                    </div>
                </main><!-- /Fim do container principal -->
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="delete-edificio" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content border border-danger">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenterTitle">Confirmação de exclusão</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body text-danger text-center">
                        <h5>Deseja remover o edificio</h5>
                        <h2 id="nome"> nome do edificio</h2>
                        <h5 class="text-warning">Esta ação não tem reparo.</h5>
                    </div>
                    <div class="modal-footer">
                        <form action="/edificio/remover" method="post">
                            <button type="button" class="btn btn-info" data-dismiss="modal">Fechar</button>
                            <button type="submit" id="excluir" name="id"
                                    value="" class="btn btn-danger">
                                Remover
                            </button>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </body>
    <!-- jQuery 3.3.1 -->
    <script th:replace="~{fragments/javascript :: jquery}"></script>
    <!-- Popper -->
    <script th:replace="~{fragments/javascript :: popper}"></script>
    <!-- bootstrap 4.0.1 -->
    <script th:replace="~{fragments/javascript :: bootstrap}"></script>
    <!-- DataTables jquery --> 
    <script th:replace="~{fragments/javascript :: dataTables-jquery}"></script>
    <!-- DataTables bootstrap -->
    <script th:replace="~{fragments/javascript :: dataTables-bootstrap}"></script>
    <!-- dataTable config -->
    <script th:replace="~{fragments/javascript :: dataTables-config}"></script>
    <!-- Modal config -->
    <script th:replace="~{fragments/javascript :: modal-config}"></script>
</html>